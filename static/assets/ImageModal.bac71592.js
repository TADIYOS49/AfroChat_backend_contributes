import{r as z,c as f,h as b,bF as W,cu as re,cv as se,b$ as ce,bR as de,bH as le,g as H,H as G,c6 as B,c2 as fe,c9 as me,c1 as ve,c7 as ge,cL as be,cM as pe,d as he,cb as J,bS as ye,bT as _e,bU as xe,bc as ke,aN as M,a9 as U,bg as T,f as S,M as $,ai as Ce,aa as Z,cc as ee}from"./index.9318a740.js";import{u as Se,a as Fe}from"./use-dark.bbec077c.js";import{a as ne,j as Ve,u as Ie,b as qe,d as ze,c as we,e as De,f as te}from"./use-key-composition.a30091f4.js";import{b as N,a as Te,Q as je}from"./QCard.9bf82158.js";import{Q as Qe}from"./QItemLabel.f5ebb189.js";import{Q as Ae,l as Ee}from"./QDialog.05df106c.js";import{u as Ne,Q as Pe}from"./QInput.3b735948.js";import{h as Be,u as L,S as K,c as Re}from"./chat-store.775f2457.js";import{_ as Oe}from"./plugin-vue_export-helper.21dcd24c.js";function Me(e,c){const g=z(null),h=f(()=>e.disable===!0?null:b("span",{ref:g,class:"no-outline",tabindex:-1}));function o(s){const m=c.value;s!==void 0&&s.type.indexOf("key")===0?m!==null&&document.activeElement!==m&&m.contains(document.activeElement)===!0&&m.focus():g.value!==null&&(s===void 0||m!==null&&m.contains(s.target)===!0)&&g.value.focus()}return{refocusTargetEl:h,refocusTarget:o}}var Ue={xs:30,sm:35,md:40,lg:50,xl:60};const $e=b("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[b("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),b("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]);var ae=W({name:"QRadio",props:{...Se,...re,...ne,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(e,{slots:c,emit:g}){const{proxy:h}=H(),o=Fe(e,h.$q),s=se(e,Ue),m=z(null),{refocusTargetEl:k,refocusTarget:y}=Me(e,m),v=f(()=>G(e.modelValue)===G(e.val)),_=f(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(e.disable===!0?" disabled":"")+(o.value===!0?" q-radio--dark":"")+(e.dense===!0?" q-radio--dense":"")+(e.leftLabel===!0?" reverse":"")),F=f(()=>{const a=e.color!==void 0&&(e.keepColor===!0||v.value===!0)?` text-${e.color}`:"";return`q-radio__inner relative-position q-radio__inner--${v.value===!0?"truthy":"falsy"}${a}`}),V=f(()=>(v.value===!0?e.checkedIcon:e.uncheckedIcon)||null),w=f(()=>e.disable===!0?-1:e.tabindex||0),j=f(()=>{const a={type:"radio"};return e.name!==void 0&&Object.assign(a,{".checked":v.value===!0,"^checked":v.value===!0?"checked":void 0,name:e.name,value:e.val}),a}),u=Ve(j);function I(a){a!==void 0&&(B(a),y(a)),e.disable!==!0&&v.value!==!0&&g("update:modelValue",e.val,a)}function Q(a){(a.keyCode===13||a.keyCode===32)&&B(a)}function t(a){(a.keyCode===13||a.keyCode===32)&&I(a)}return Object.assign(h,{set:I}),()=>{const a=V.value!==null?[b("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[b(ce,{class:"q-radio__icon",name:V.value})])]:[$e];e.disable!==!0&&u(a,"unshift"," q-radio__native q-ma-none q-pa-none");const i=[b("div",{class:F.value,style:s.value,"aria-hidden":"true"},a)];k.value!==null&&i.push(k.value);const d=e.label!==void 0?de(c.default,[e.label]):le(c.default);return d!==void 0&&i.push(b("div",{class:"q-radio__label q-anchor--skip"},d)),b("div",{ref:m,class:_.value,tabindex:w.value,role:"radio","aria-label":e.label,"aria-checked":v.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:I,onKeydown:Q,onKeyup:t},i)}}});function A(e,c,g,h){const o=[];return e.forEach(s=>{h(s)===!0?o.push(s):c.push({failedPropValidation:g,file:s})}),o}function P(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),B(e)}const Le={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ke=["rejected"];function We({editable:e,dnd:c,getFileInput:g,addFilesToQueue:h}){const{props:o,emit:s,proxy:m}=H(),k=z(null),y=f(()=>o.accept!==void 0?o.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),v=f(()=>parseInt(o.maxFiles,10)),_=f(()=>parseInt(o.maxTotalSize,10));function F(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&fe(t);else{const a=g();a&&a!==t.target&&a.click(t)}}function V(t){e.value&&t&&h(null,t)}function w(t,a,i,d){let n=Array.from(a||t.target.files);const C=[],D=()=>{C.length!==0&&s("rejected",C)};if(o.accept!==void 0&&y.value.indexOf("*/")===-1&&(n=A(n,C,"accept",r=>y.value.some(p=>r.type.toUpperCase().startsWith(p)||r.name.toUpperCase().endsWith(p))),n.length===0))return D();if(o.maxFileSize!==void 0){const r=parseInt(o.maxFileSize,10);if(n=A(n,C,"max-file-size",p=>p.size<=r),n.length===0)return D()}if(o.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),d===!0){const r=i.map(p=>p.__key);n=A(n,C,"duplicate",p=>r.includes(p.__key)===!1)}if(n.length===0)return D();if(o.maxTotalSize!==void 0){let r=d===!0?i.reduce((p,R)=>p+R.size,0):0;if(n=A(n,C,"max-total-size",p=>(r+=p.size,r<=_.value)),n.length===0)return D()}if(typeof o.filter=="function"){const r=o.filter(n);n=A(n,C,"filter",p=>r.includes(p))}if(o.maxFiles!==void 0){let r=d===!0?i.length:0;if(n=A(n,C,"max-files",()=>(r++,r<=v.value)),n.length===0)return D()}if(D(),n.length!==0)return n}function j(t){P(t),c.value!==!0&&(c.value=!0)}function u(t){B(t),(t.relatedTarget!==null||me.is.safari!==!0?t.relatedTarget!==k.value:document.elementsFromPoint(t.clientX,t.clientY).includes(k.value)===!1)===!0&&(c.value=!1)}function I(t){P(t);const a=t.dataTransfer.files;a.length!==0&&h(null,a),c.value=!1}function Q(t){if(c.value===!0)return b("div",{ref:k,class:`q-${t}__dnd absolute-full`,onDragenter:P,onDragover:P,onDragleave:u,onDrop:I})}return Object.assign(m,{pickFiles:F,addFiles:V}),{pickFiles:F,addFiles:V,onDragover:j,onDragleave:u,processFiles:w,getDndNode:Q,maxFilesNumber:v,maxTotalSizeNumber:_}}var He=W({name:"QFile",inheritAttrs:!1,props:{...Ie,...ne,...Le,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...qe,...Ke],setup(e,{slots:c,emit:g,attrs:h}){const{proxy:o}=H(),s=ze(),m=z(null),k=z(!1),y=we(e),{pickFiles:v,onDragover:_,onDragleave:F,processFiles:V,getDndNode:w}=We({editable:s.editable,dnd:k,getFileInput:X,addFilesToQueue:Y}),j=Ne(e),u=f(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),I=f(()=>te(u.value)),Q=f(()=>u.value.map(l=>l.name).join(", ")),t=f(()=>Be(u.value.reduce((l,x)=>l+x.size,0))),a=f(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),i=f(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:y.value,...h,id:s.targetUid.value,disabled:s.editable.value!==!0})),d=f(()=>"q-file q-field--auto-height"+(k.value===!0?" q-file--dnd":"")),n=f(()=>e.multiple===!0&&e.append===!0);function C(l){const x=u.value.slice();x.splice(l,1),r(x)}function D(l){const x=u.value.indexOf(l);x>-1&&C(x)}function r(l){g("update:modelValue",e.multiple===!0?l:l[0])}function p(l){l.keyCode===13&&ge(l)}function R(l){(l.keyCode===13||l.keyCode===32)&&v(l)}function X(){return m.value}function Y(l,x){const q=V(l,x,u.value,n.value),O=X();O!=null&&(O.value=""),q!==void 0&&((e.multiple===!0?e.modelValue&&q.every(ue=>u.value.includes(ue)):e.modelValue===q[0])||r(n.value===!0?u.value.concat(q):q))}function E(){return[b("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ie(){if(c.file!==void 0)return u.value.length===0?E():u.value.map((x,q)=>c.file({index:q,file:x,ref:this}));if(c.selected!==void 0)return u.value.length===0?E():c.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?E():u.value.map((x,q)=>b(Ae,{key:"file-"+q,removable:s.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{C(q)}},()=>b("span",{class:"ellipsis",textContent:x.name})));const l=e.displayValue!==void 0?e.displayValue:Q.value;return l.length!==0?[b("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:E()}function oe(){const l={ref:m,...i.value,...j.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:Y};return e.multiple===!0&&(l.multiple=!0),b("input",l)}return Object.assign(s,{fieldClass:d,emitValue:r,hasValue:I,inputRef:m,innerValue:u,floatingLabel:f(()=>I.value===!0||te(e.displayValue)),computedCounter:f(()=>{if(e.counterLabel!==void 0)return e.counterLabel(a.value);const l=e.maxFiles;return`${u.value.length}${l!==void 0?" / "+l:""} (${t.value})`}),getControlChild:()=>w("file"),getControl:()=>{const l={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return s.editable.value===!0&&Object.assign(l,{onDragover:_,onDragleave:F,onKeydown:p,onKeyup:R}),b("div",l,[oe()].concat(ie()))}}),Object.assign(o,{removeAtIndex:C,removeFile:D,getNativeElement:()=>m.value}),ve(o,"nativeEl",()=>m.value),De(s)}}),Xe=W({name:"QCardActions",props:{...be,vertical:Boolean},setup(e,{slots:c}){const g=pe(e),h=f(()=>`q-card__actions ${g.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>b("div",{class:h.value},le(c.default))}});const Ye=he({__name:"ImageModal",props:{image_modal:{type:Boolean}},setup(e){const{isAssistantTyping:c}=J(L()),g=ye(),{Chat:h}=L(),{sub_tool_id:o,chat_session_id:s}=J(L()),m=_e();let k=e;const y=z("describe"),v=z(k.image_modal),_=z(""),F=z(""),{is_dark_theme:V}=xe(),w=z(null);function j(a){console.log(a),g.notify({color:"negative",message:"error"})}async function u(a){if(!a)return;const i=new FormData;i.append("file",a),i.append("upload_preset","tools_image"),i.append("cloud_name","afrochat");try{const n=await(await fetch("https://api.cloudinary.com/v1_1/afrochat/image/upload",{method:"POST",body:i})).json();console.log(n.url),_.value=n.url}catch(d){console.error("Error uploading image:",d)}}function I(){return _.value===""?(g.notify({color:"negative",message:"Upload an Image first!"}),!1):y.value==="edit"&&!F.value?(g.notify({color:"negative",message:"Please describe the edit information"}),!1):!0}async function Q(){if(!!I()){if(y.value==="describe")s.value===""&&m.push({name:"chat",params:{id:K.DescribeImage},query:{name:"Describe Image",image:"https://res.cloudinary.com/afrochat/image/upload/v1699543455/imag.png"}}),c.value=!0,o.value=K.DescribeImage,v.value=!v.value,setTimeout(()=>{const a=document.getElementById("bottom-of-chat");a==null||a.scrollIntoView({behavior:"smooth",block:"end"})},100),await h(_.value).then(()=>{c.value=!1});else if(y.value==="edit"){const a=await Re(F.value,K.EditImage,"Gemini Pro",_.value);console.log(a.data)}}}ke(()=>{v.value=k.image_modal});function t(){console.log("Edit clicked"),g.notify({color:"light-blue-8",message:"Edit is not available yet!",timeout:200})}return(a,i)=>(M(),U(Ee,{class:"image-modal",modelValue:v.value,"onUpdate:modelValue":i[5]||(i[5]=d=>v.value=d)},{default:T(()=>[S(je,{style:{"min-width":"300px","border-radius":"4.4%"},class:"q-px-sm q-pb-md bg-secondary text-info"},{default:T(()=>[S(N,null,{default:T(()=>[S(ae,{onClick:t,dark:$(V),modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=d=>y.value=d),val:"edit",label:"Edit Image",disable:""},null,8,["dark","modelValue"]),S(ae,{dark:$(V),modelValue:y.value,"onUpdate:modelValue":i[1]||(i[1]=d=>y.value=d),val:"describe",label:"Describe Image"},null,8,["dark","modelValue"])]),_:1}),S(Qe,{header:""},{default:T(()=>[Ce("Upload")]),_:1}),S(N,null,{default:T(()=>[S(He,{"bg-color":"primary",color:"info",dark:$(V),style:{"max-width":"300px"},modelValue:w.value,"onUpdate:modelValue":[i[2]||(i[2]=d=>w.value=d),u],outlined:"",accept:"image/*",label:"Max file size (2MB)",onRejected:j},null,8,["dark","modelValue"])]),_:1}),y.value==="edit"?(M(),U(N,{key:0},{default:T(()=>[S(Pe,{modelValue:F.value,"onUpdate:modelValue":i[3]||(i[3]=d=>F.value=d),filled:"",clearable:"",autogrow:"",class:"bg-primary",label:"Describe the edit information"},null,8,["modelValue"])]),_:1})):Z("",!0),_.value?(M(),U(N,{key:1},{default:T(()=>[S(Te,{src:_.value,"spinner-color":"info",style:{"max-width":"100%","object-fit":"cover"}},null,8,["src"])]),_:1})):Z("",!0),S(Xe,{class:"bottom-card-action"},{default:T(()=>[S(ee,{flat:"",label:"Cancel",class:"bg-warning text-info",onClick:i[4]||(i[4]=()=>v.value=!1)}),S(ee,{flat:"",label:"Submit",class:"bg-accent text-info",onClick:Q})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var ot=Oe(Ye,[["__scopeId","data-v-e5b5f7e6"]]);export{ot as I,ae as Q};
